---
title: "[Next.js] ìƒí™œì½”ë”© Next.js"
categories: [Next.js]
toc_label: Contents
toc: true
toc_sticky: true
author_profile: true
sidebar:
  nav: "counts"
---

<br>

> [ìƒí™œì½”ë”© Next.js 13](https://www.youtube.com/watch?v=9KOaR6QMb9A&list=PLuHgQVnccGMCwxXsQuEoG-JJ7RlwtNdwJ)

<br>

# 0. Next.jsë€ ë¬´ì—‡ì¸ê°€?

- ë¦¬ì•¡íŠ¸ëŠ” <span style="color:indianred">í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´íŠ¸ ë Œë”ë§</span> -> js ë™ì‘í•˜ì§€ ì•Šê±°ë‚˜ ë‹¤ìš´ë°›ì„ ìˆ˜ ì—†ëŠ” í™˜ê²½ì—ì„  í™”ë©´ì— í‘œì‹œë˜ì§€ ì•ŠëŠ” ë¬¸ì œ
- Next.jsëŠ” <span style="color:indianred">ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§</span> ì§€ì›
  - ì„œë²„ìª½ì—ì„œ jsê°€ ì‹¤í–‰ë¨, ì™„ì„±ëœ HTMLì„ ë¸Œë¼ìš°ì €ì—ê²Œ ì „ì†¡í•˜ê¸° ë•Œë¬¸ì— jsë¥¼ ì‹¤í–‰í•  ìˆ˜ ì—†ëŠ” í™˜ê²½ì—ì„œë„ ì˜ ë™ì‘ -> ê²€ìƒ‰ ì¹œí™”ì 
  - ë‹¤ìš´ë¡œë“œ ë°›ëŠ” ì¦‰ì‹œ ì‹¤í–‰

<br>

# 1. ì„¤ì¹˜ì™€ ì‹¤í–‰

â‘  node.js ì„¤ì¹˜

â‘¡ `npx create-next-app@latest .` // latestëŠ” ìµœì‹  ë²„ì „ ì„¤ì¹˜í•œë‹¤ëŠ” ì˜ë¯¸

![](/assets/images/2024/2024-03-20-11-57-57.png)

â‘¢ `npm run dev`ë¡œ ì‹¤í–‰

<br>

# 2. ìƒ˜í”Œ ì•± ì„¸íƒ

1. layout.jsì´ ê³¨ê²© êµ¬ì„±
2. `<body>{children}</body>`ì—ì„œ childrenì˜ ì •ì²´? -> page.jsì˜ ë¦¬í„´ ê°’

page.jsì˜ ë¦¬í„´ ê°’ì´ layout.jsë¡œ ë“¤ì–´ê°€ëŠ” ê²ƒì€ ê·¸ í˜ì´ì§€ê°€ í•´ë‹¹ ë ˆì´ì•„ì›ƒì„ ì‚¬ìš©í•˜ê² ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸

```js
// app > layout.js
import "./globals.css";

export const metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({ children }) {
  return (
    <html>
      <body>{children}</body>
    </html>
  );
}
```

```js
// app > page.js
export default function Home() {
  return <div>(âÂ´â—¡`â)</div>;
}
```

![](/assets/images/2024/2024-03-20-12-01-46.png)

<br>

# 3. ë°°í¬

ë°°í¬ ì–´ë–»ê²Œí•˜ì§€?

- `npm run build`ë¡œ ë°°í¬íŒ ë§Œë“¤ê³ ,
- `npm run start`ë¡œ ë°°í¬íŒ ì‹¤í–‰

<br>

# 4. ë¼ˆëŒ€ ë§Œë“¤ê¸°

- app > page.jsê°€ ë¦¬í„´í•˜ëŠ” ê°’ì´ ì»¨í…íŠ¸
- ê³µí†µëœ ë ˆì´ì•„ì›ƒ ë‹¤ë£¨ê¸° : layout.js í™œìš©
- íƒ€ì´í‹€ ì²˜ë¦¬í•˜ëŠ” ë°©ë²• : metadataë¥¼ export

```js
// app > layout.js
import "./globals.css";

export const metadata = {
  title: "Web tutorials",
  description: "Generated by sieun",
};

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        <h1>
          <a href="/">WEB</a>
        </h1>
        <ol>
          <li>
            <a href="/read/1">html</a>
          </li>
          <li>
            <a href="/read/2">css</a>
          </li>
        </ol>
        {children}
        <ul>
          <li>
            <a href="/create">Create</a>
          </li>
          <li>
            <a href="/update/1">Update</a>
          </li>
          <li>
            <input type="button" value="delete"></input>
          </li>
        </ul>
      </body>
    </html>
  );
}
```

![](/assets/images/2024/2024-03-20-12-09-14.png)

<br>

# 5. ë¼ìš°íŒ…

> ë¼ìš°íŒ…ì´ë€? ê²½ë¡œì— ë”°ë¼ ì–´ë–¤ ì»¨í…ì¸ ë¥¼ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ë³´ì—¬ì¤„ ê²ƒì¸ê°€ë¥¼ ê²°ì •í•˜ëŠ” ê²ƒ

â‘  app ë°‘ì— í´ë”(ex: create) > page.js íŒŒì¼ ìƒì„± í›„ ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°

â‘¡ next.jsëŠ” app í´ë” ë°‘ create í´ë”ë¥¼ ì°¾ê³ , ê·¸ í´ë”ê°€ page.js íŒŒì¼ì„ ê°–ê³  ìˆëŠ”ì§€ í™•ì¸

â‘¢ page.jsì˜ ë¦¬í„´ ê°’ì€ layout.jsì˜ childrenì— ê²°í•©í•´ ë§Œë“¤ì–´ì§„ ìµœì¢…ì ì¸ htmlì‘ë‹µ

![](/assets/images/2024/2024-03-20-12-29-34.png)
![](/assets/images/2024/2024-03-20-12-27-38.png)

â‘£ ê·¸ëŸ¼ `http://localhost:3000/read/1`,`http://localhost:3000/read/2`ì™€ ê°™ì€ ê²½ë¡œ ì„¤ì •ì€ ì–´ë–»ê²Œí•´? -> ë‹¤ì´ë‚˜ë¯¹ ë¼ìš°íŒ… ì‚¬ìš©

<br>

> ë‹¤ì´ë‚˜ë¯¹ ë¼ìš°íŒ… ì˜ˆì‹œ

- app > read í´ë” ìƒì„±
- ê·¸ í›„ app > read > [id] ìƒì„± í›„ ì•„ë˜ë‹¤ê°€ page.js ìƒì„±
- ì´ì œ `localhost3000/read/1`,`localhost3000/read/2` ë“± ì ‘ê·¼ ê°€ëŠ¥

<br>

> ê²½ë¡œ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ë°?

app > read > [id] > page.jsì— propsë¥¼ ì£¼ê³  `{props.params.id}`ë¡œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.

![](/assets/images/2024/2024-03-20-12-36-09.png)

![](/assets/images/2024/2024-03-20-12-34-34.png)

<br>

# 6. single page application

> single page application?

- ì›¹ í˜ì´ì§€ê°€ ì—¬ëŸ¬ ê°œì˜ ì›¹í˜ì´ì§€ì„ì—ë„ ë¶ˆêµ¬í•˜ê³  ë§ˆì¹˜ í•œ í˜ì´ì§€ì²˜ëŸ¼ ë™ì‘í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹±ê¸€í˜ì´ì§€ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë¼ê³  í•œë‹¤.
- aíƒœê·¸ë¥¼ Linkë¡œ ë°”ê¾¸ëŠ” ê²ƒ ë§Œìœ¼ë¡œë„ single page application êµ¬í˜„ ê°€ëŠ¥

<br>

> ì„œë²„ì‚¬ì´ë“œ ë Œë”ë§?

- jsê°€ êº¼ì ¸ë„ ì„œë²„ì‚¬ì´íŠ¸ ë Œë”ë§ì€ nextí´ë”ì— next.jsê°€ ì„œë²„ìª½ì—ì„œ ë¦¬ì•¡íŠ¸ë¥¼ ì‹¤í–‰í•´ì„œ ì‘ë‹µ ê²°ê³¼ë¥¼ nextì— ì €ì¥í•´ì„œ ê·¸ê²ƒì„ ì‘ë‹µ
- next.jsëŠ” jsê°€ ì•„ë‹Œ htmlì„ ì‘ë‹µí•˜ê¸° ë•Œë¬¸ì— js êº¼ì ¸ë„ ë¨ -> ê²€ìƒ‰ì—”ì§„ ìµœì í™” ìœ ë¦¬

<br>

> a vs Link?

- Link ì»´í¬ë„ŒíŠ¸ëŠ” ë§í¬ì—ë‹¤ê°€ ë§ˆìš°ìŠ¤ ì˜¬ë ¤ë†“ìœ¼ë©´ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë¯¸ë¦¬ í˜ì´ì§€ë¥¼ ë‹¤ìš´ë¡œë“œ ë°›ìŒ(ë°œì ëª¨ë“œ NetWork íƒ­ì—ì„œ í™•ì¸í•´ë³´ê¸°)
- ë°©ë¬¸í–ˆë˜ í˜ì´ì§€ ë‹¤ì‹œ ë°©ë¬¸í•˜ë ¤ê³  í•˜ë©´ ì•„ì˜ˆ ì„œë²„ë‘ í†µì‹  x -> ë¹ ë¦„
- aíƒœê·¸ ì“°ì§€ ë§ì

```js
// add > layout.js
import Link from "next/link";
import "./globals.css";

export const metadata = {
  title: "Web tutorials",
  description: "Generated by sieun",
};

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        <h1>
          <Link href="/">WEB</Link>
        </h1>
        <ol>
          <li>
            <Link href="/read/1">html</Link>
          </li>
          <li>
            <Link href="/read/2">css</Link>
          </li>
        </ol>
        {children}
        <ul>
          <li>
            <Link href="/create">Create</Link>
          </li>
          <li>
            <Link href="/update/1">Update</Link>
          </li>
          <li>
            <input type="button" value="delete"></input>
          </li>
        </ul>
      </body>
    </html>
  );
}
```

<br>

# 7. ì •ì  ìì› ì‚¬ìš©í•˜ê¸°

> next.jsì—ì„œ ì´ë¯¸ì§€ì™€ ê°™ì€ ì •ì ì¸ ì»¨í…ì¸  ì–´ë–»ê²Œ ì‚¬ìš©?

-> pubulic í´ë”ì— ì´ë¯¸ì§€ë¥¼ ìœ„ì¹˜ì‹œí‚¤ë©´ ë¨

<br>

> ì´ íŒŒì¼ ì–´ë–»ê²Œ ì½ì–´ì˜´?

- page.jsì—ì„œ img íƒœê·¸ë¥¼ ì“°ê³  srcë¡œ ê²½ë¡œ ì„¤ì •

  ```js
  export default function Home() {
    return (
      <div>
        (âÂ´â—¡`â)
        <img src="/dog.png"></img>
      </div>
    );
  }
  ```

  ![](/assets/images/2024/2024-03-20-12-44-18.png)

<br>

# 8. css

- src ë°”ë¡œ í•˜ìœ„ì— ìˆëŠ” layout.jsëŠ” root layoutì´ê¸° ë•Œë¬¸ì— ì–´ë–¤ í˜ì´ì§€ë¥¼ ë°©ë¬¸í•˜ê±´ ê°„ì— global.css íŒŒì¼ì´ ë¡œë“œë¨
- ì¦‰, ì „ì—­ì ìœ¼ë¡œ ë””ìì¸ ì ìš© ê°€ëŠ¥

<br>

# 9. backend

â‘  json ì„œë²„ ì„¤ì¹˜

```shell
npx json-server@0.17.4 --port 9999 --watch db.json
```

--watchëŠ” íŒŒì¼ ì •ë³´ê°€ ë°”ë€Œë©´ ë°”ë¡œ ì„œë²„ì— ë°˜ì˜í•˜ê¸° ìœ„í•œ ì˜µì…˜ì„

<br>

â‘¡ ê·¸ í›„, ìƒì„±ëœ db.jsonì„ ìš©ë„ì— ë§ê²Œ ìˆ˜ì •í•˜ê¸° -> ê·¸ ê²½ë¡œ ë“¤ì–´ê°€ë©´ íŒŒì¼ì´ ìˆëŠ” ë‚´ìš©ì„ json í˜•íƒœë¡œ ì‘ë‹µ

topicsë¡œ ë“¤ì–´ê°€ë©´ ê¸€ ëª©ë¡ì„ ë³´ì—¬ì£¼ê³  ì‹¶ìœ¼ë©´ ì•„ë˜ì™€ ê°™ì´ db.json ìˆ˜ì •

```json
{
  "topics": [
    {
      "id": 1,
      "title": "html",
      "body": "html is ..."
    },
    {
      "id": 2,
      "title": "css",
      "body": "css is ..."
    }
  ],
  "posts": [
    {
      "id": 1,
      "title": "json-server",
      "author": "typicode"
    }
  ],
  "comments": [
    {
      "id": 1,
      "body": "some comment",
      "postId": 1
    }
  ],
  "profile": {
    "name": "typicode"
  }
}
```

<br>

> ê·¸ëŸ¼ dataë¥¼ js íŒŒì¼ë¡œ ì–´ë–»ê²Œ ê°€ì ¸ì˜¤ëŠ”ë°?

ë¸Œë¼ìš°ì € console ì°½ì—ì„œ ì„œë²„ì™€ í†µì‹ í•  ë•Œ ì‚¬ìš©í•˜ëŠ” fetch ëª…ë ì–´ë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŒ

`fetch().then().then()` <- ì´ê²Œ ê¸°ë³¸ í˜•íƒœ

```js
fetch("http://localhost:9999/topics")
  .then((res) => {
    return res.json();
  })
  .then((result) => {
    console.log("result", result);
  });
```

![](/assets/images/2024/2024-03-20-00-54-57.png)

<br>

# 10. ê¸€ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°

> next.js(React 18ì— ì¡´ì¬í•˜ëŠ” ê°œë…)ì—” Server Componentì™€ Client Componentë¼ëŠ” ê°œë…ì´ ì¡´ì¬

![](/assets/images/2024/2024-03-20-14-36-58.png)

- ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬ê°€ ì¤‘ìš”í•¨ â†’ ì‚¬ìš©ìì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë§Œ í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ë¡œ, ë‹¨ìˆœíˆ ì„œë²„ ì •ë³´ë¥¼ ë³´ì—¬ì£¼ëŠ” ì—­í• ì„ í•˜ëŠ” ê²ƒì€ ì„œë²„ ì»´í¬ë„ŒíŠ¸ë¡œ ë§Œë“¤ê¸°

```js
// app > layout.js

import Link from "next/link";
import "./globals.css";
import { useEffect, useState } from "react";

export const metadata = {
  title: "Web tutorials",
  description: "Generated by sieun",
};

export default function RootLayout({ children }) {
  const [topics, setTopics] = useState([]);
  useEffect(() => {
    fetch("http://localhost:9999/topics")
      .then((res) => res.json())
      .then((result) => {
        setTopics(result);
      });
  }, []);
  return (
    <html>
      <body>... ìƒëµ</body>
    </html>
  );
}
```

<br>

- í•˜ì§€ë§Œ ìœ„ ì½”ë“œ ì˜¤ë¥˜ ë°œìƒ -> useEffectì™€ useStateëŠ” í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ ë™ì‘í•˜ê¸° ë•Œë¬¸
- â­next.jsëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì„œë²„ ì»´í¬ë„ŒíŠ¸ë¼ê³  ê°„ì£¼í•¨

<br>

> í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ë¡œ ë³€ê²½í•˜ê¸° ìœ„í•´ ìƒë‹¨ì— `"use client";` ì‘ì„±

- ë˜ ì˜¤ë¥˜ ë°œìƒ -> matadataëŠ” ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ ì‘ë™í•˜ê¸° ë•Œë¬¸
- ë”°ë¼ì„œ ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬ê°€ í•„ìš”í•¨ -> ì„œë²„ ì»´í¬ë„ŒíŠ¸ëŠ” í•œ ë²ˆ ë Œë”ë§ ë˜ë©´ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë³´ë‚´ì£¼ëŠ” ì—­í• ë§Œ í•˜ë©´ ë¨

ì½”ë“œë¥¼ ì•„ë˜ì™€ ê°™ì´ ë³€ê²½

```js
// ë³€ê²½ ì „
"use client";

const [topics, setTopics] = useState([]);
useEffect(() => {
  fetch("http://localhost:9999/topics")
    .then((res) => res.json())
    .then((result) => {
      setTopics(result);
    });
}, []);
```

<br>

```js
// ë³€ê²½ í›„
const res = await fetch("http://localhost:9999/topics");
const topics = await res.json();
```

- ì„œë²„ ì¸¡ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½

<br>

# 11. ê¸€ ì½ê¸°

ì‚¬ìš©ìì™€ ìƒí˜¸ì‘ìš© í•˜ì§€ ì•ŠëŠ” ì»´í¬ë„ŒíŠ¸ -> ì„œë²„ì»´í¬ë„ŒíŠ¸ë¡œ ë§Œë“¤ê¸°

```js
// app > read > [id] > page.js
import React from "react";

const ReadPage = async (props) => {
  const res = await fetch(`http://localhost:9999/topics/${props.params.id}`);
  const topic = await res.json();
  return (
    <>
      <h2>{topic.title}</h2>
      <div> {topic.body}</div>
    </>
  );
};

export default ReadPage;
```

![](/assets/images/2024/2024-03-20-17-06-55.png)

<br>

# 12. ê¸€ ìƒì„±

```js
// app > create > page.js
"use client";
import React from "react";

const CratePage = () => {
  return (
    <form
      onSubmit={(e) => {
        e.preventDefault();
        const title = e.target.title.value;
        const body = e.target.body.value;
        // ì„œë²„ì—ì„œ ë°ì´í„° ì „ì†¡í•´ ì¶”ê°€í•˜ë ¤ê³  í•˜ëŠ” ê±°ê¸° ë•Œë¬¸ì— ì˜µì…˜ ê°’ í•„ìš”í•¨
        const options = {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ title, body }),
        };
        fetch("http://localhost:9999/topics", options)
          .then((res) => res.json())
          .then((result) => {
            console.log(result);
          });
      }}
    >
      <p>
        <input type="text" name="title" placeholder="title" />
      </p>
      <p>
        <textarea name="body" placeholder="body" />
      </p>
      <p>
        <input type="submit" value="create" />
      </p>
    </form>
  );
};

export default CratePage;
```

![](/assets/images/2024/2024-03-20-17-17-00.png)

<br>

> ê·¸ëŸ¼ ì‚¬ìš©ìê°€ ë³´ê³  ìˆëŠ” í˜ì´ì§€ë¥¼ ë°©ê¸ˆ ìƒì„±í•œ idì— í•´ë‹¹í•˜ëŠ” ê¸€ë¡œ ì´ë™í•˜ê²Œ í•˜ê³  ì‹¶ìœ¼ë©´ ì–´ë–»ê²Œí•¨?

client ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” useRouter ì‚¬ìš©í•˜ë©´ ë¨

```js
"use client";
import React from "react";
import { useRouter } from "next/navigation"; // import (ì£¼ì˜: navigationì—ì„œ import)

const CratePage = () => {
  const router = useRouter(); // useRouter ì‚¬ìš©
  return (
    <form
      onSubmit={(e) => {
        e.preventDefault();
        const title = e.target.title.value;
        const body = e.target.body.value;
        const options = {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ title, body }),
        };
        fetch("http://localhost:9999/topics", options)
          .then((res) => res.json())
          .then((result) => {
            console.log(result);
            const lastid = result.id; //idê°’ ë°›ê¸°
            router.push(`/read/${lastid}`); // ë°©ê¸ˆ ìƒì„±í•œ ê¸€ë¡œ ë¦¬ë””ë ‰ì…˜
          });
      }}
    >
      <p>
        <input type="text" name="title" placeholder="title" />
      </p>
      <p>
        <textarea name="body" placeholder="body"></textarea>
      </p>
      <p>
        <input type="submit" value="create" />
      </p>
    </form>
  );
};

export default CratePage;
```

ê·¸ëŸ°ë° ìœ„ ì½”ë“œ ë¬¸ì œê°€ ìˆìŒ -> ìƒì„±í•œ ê¸€ ëª©ë¡ì´ ê°±ì‹ ì´ ì•ˆë¨

<br>

# 13. cache

ìƒì„±í•œ ê¸€ ëª©ë¡ì´ ê°±ì‹ ì´ ì•ˆë˜ëŠ” ë¬¸ì œ -> cacheì™€ ê´€ë ¨ ìˆìŒ

- í•´ê²° ë°©ì•ˆ : fetchë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ í›„ cacheë¡œ ë§Œë“¤ì§€ ì•Šìœ¼ë©´ ë¨(ì„±ëŠ¥ í¬ìƒ -> ì¶”í›„ ë‹¤ë¥¸ ë°©ë²• ê³µë¶€í•˜ê¸°)
- fetch í•  ë•Œ ` { next: { revalidate: 10 } }`ë¥¼ ì˜µì…˜ìœ¼ë¡œ ì£¼ì
- 10ì´ˆ ë™ì•ˆë§Œ chachë¥¼ ìœ ì§€í•˜ê² ë‹¤ëŠ” ëœ»

cacheë¥¼ ë§Œë“¤ì§€ ì•Šê¸° ìœ„í•´ revalidateë¥¼ 0ìœ¼ë¡œ ë³€ê²½

<br>

` { cache: "no-store" }` ì˜µì…˜ ì¨ë„ ë¨ ìºì‹œë¥¼ ì €ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ëœ»

```js
// app > layout.js
export default async function RootLayout({ children }) {
  const res = await fetch("http://localhost:9999/topics", {
    cache: "no-store",
  });
```

<br>

Next.jsì˜ ë¼ìš°íŒ… APIì¸ refreshë¥¼ ì‚¬ìš©í•˜ì—¬ í˜„ì¬ í˜ì´ì§€ë¥¼ ë‹¤ì‹œ ë¡œë“œí•˜ì—¬ ìƒˆë¡œê³ ì¹¨

```js
// app > crate > page.js
fetch("http://localhost:9999/topics", options)
  .then((res) => res.json())
  .then((result) => {
    console.log(result);
    const lastid = result.id;
    router.push(`/read/${lastid}`);
    router.refresh(); //
  });
```

<br>

# 14. í•„ìš”í•  ë•Œ update, delete ê¸°ëŠ¥ ë³´ì´ê¸°

ê¸€ì„ ì„ íƒí–ˆì„ ë•Œë§Œ update, delete ê¸°ëŠ¥ì´ í‘œì‹œë˜ë„ë¡ ê°œì„ ì„ í•´ë³´ì

ë§í¬ì— idê°€ ìˆëŠ”ì§€ ì²´í¬í•´ì•¼í•¨
![](/assets/images/2024/2024-03-20-18-23-26.png)

- [id] ë°–ì— ìœ„ì¹˜í•œ root layoutì€ ì–´ë–»ê²Œ id ì•Œì•„ë‚´ì§€? -> useParams ì‚¬ìš©(useParamsë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ë° useParamsëŠ” client component hook)
- root layoutì€ ì„œë²„ ì»´í¬ë„ŒíŠ¸ë¡œ ì´ë£¨ì–´ì ¸ ìˆëŠ”ë° ì–´ë–»ê²Œí•¨? -> app/Control.js ìƒì„±í•´ì„œ ë³„ë„ì˜ íŒŒì¼ë¡œ ë¶„ë¦¬

```js
// app > Control.js
"use client";
import Link from "next/link";
import { useParams } from "next/navigation";
import React from "react";

const Control = () => {
  const params = useParams();
  const id = params.id;
  return (
    <ul>
      <li>
        <Link href="/create">Create</Link>
      </li>
      {id ? (
        <>
          <li>
            <Link href={`/update/${id}`}>Update</Link>
          </li>
          <li>
            <input type="button" value="delete"></input>
          </li>
        </>
      ) : null}
    </ul>
  );
};

export default Control;
```

<br>

Control ì»´í¬ë„ŒíŠ¸ë¥¼ app/layout.jsì—ì„œ ì‚¬ìš©

```js
// app > layout.js
import Link from "next/link";
import "./globals.css";
import Control from "./Control";

export const metadata = {
  title: "Web tutorials",
  description: "Generated by sieun",
};

export default async function RootLayout({ children }) {
  const res = await fetch("http://localhost:9999/topics", {
    cache: "no-store",
  });
  const topics = await res.json();
  return (
    <html>
      <body>
        <h1>
          <Link href="/">WEB</Link>
        </h1>
        <ol>
          {topics.map((topic) => {
            return (
              <li key={topic.id}>
                <Link href={`/read/${topic.id}`}>{topic.title}</Link>
              </li>
            );
          })}
        </ol>
        {children}
        <Control />
      </body>
    </html>
  );
}
```

ì´ì œ home í™”ë©´ì—ì„  ì•ˆë³´ì´ê³  ê¸€ì„ ì„ íƒí–ˆì„ ë•Œë§Œ update, delete í‘œì‹œ

<br>

# 15. ê¸€ ìˆ˜ì •

src > update > [id] > page.js ìƒì„±

> ìˆ˜ì • ê¸°ëŠ¥ì€ read + create ê¸°ëŠ¥ì„ í•©ì¹œ ê²ƒê³¼ ê°™ìŒ.

- crate í´ë”ì˜ page.js ì½”ë“œ ìš°ì„  ê·¸ëŒ€ë¡œ ì ìš©
- updateëŠ” í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì´ê³  readëŠ” ì„œë²„ ì»´í¬ë„ŒíŠ¸ì¸ë° ì–´ë–»ê²Œí•¨? -> ìƒˆë¡œ ì½”ë“œ ì‘ì„±í•´ì•¼ì§€.. ì¬í™œìš© ë¶ˆê°€

```js
// src > update > [id] > page.js
"use client";
import React, { useEffect } from "react";
import { useParams, useRouter } from "next/navigation";

const UpdatePage = () => {
  const router = useRouter();
  const params = useParams();
  const id = params.id;
  useEffect(() => {
    fetch(`http://localhost:9999/topics/${id}`)
      .then((res) => res.json())
      .then((result) => console.log(result));
  }, []);

  return (
    <form
      onSubmit={(e) => {
        e.preventDefault();
        const title = e.target.title.value;
        const body = e.target.body.value;
        const options = {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ title, body }),
        };
        fetch("http://localhost:9999/topics", options)
          .then((res) => res.json())
          .then((result) => {
            console.log(result);
            const lastid = result.id;
            router.push(`/read/${lastid}`);
            router.refresh();
          });
      }}
    >
      <p>
        <input type="text" name="title" placeholder="title" />
      </p>
      <p>
        <textarea name="body" placeholder="body"></textarea>
      </p>
      <p>
        <input type="submit" value="create" />
      </p>
    </form>
  );
};

export default UpdatePage;
```

http://localhost:3000/update/3ì— ë“¤ì–´ê°€ë©´ consoleì°½ì— ì•„ë˜ì™€ ê°™ì´ ëœ¸

![](/assets/images/2024/2024-03-20-18-57-03.png)

<br>

ì„œë²„ì—ì„œ ê°€ì ¸ì˜¨ ê°’ìœ¼ë¡œ ì„¸íŒ…í•˜ê¸° ìœ„í•´ state ìƒì„±

```js
"use client";
import React, { useEffect, useState } from "react";
import { useParams, useRouter } from "next/navigation";

const UpdatePage = () => {
  const [title, setTitle] = useState("");
  const [body, setBody] = useState("");

  const router = useRouter();
  const params = useParams();
  const id = params.id;
  useEffect(() => {
    fetch(`http://localhost:9999/topics/${id}`)
      .then((res) => res.json())
      .then((result) => {
        setTitle(result.title);
        setBody(result.body);
      });
  }, []);

  return (
    <form
      onSubmit={(e) => {
        e.preventDefault();
        const title = e.target.title.value;
        const body = e.target.body.value;
        const options = {
          method: "PATCH",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ title, body }),
        };
        fetch(`http://localhost:9999/topics/${id}`, options)
          .then((res) => res.json())
          .then((result) => {
            console.log(result);
            const lastid = result.id;
            router.push(`/read/${lastid}`);
            router.refresh();
          });
      }}
    >
      <p>
        <input
          type="text"
          name="title"
          placeholder="title"
          value={title}
          onChange={(e) => setTitle(e.target.value)}
        />
      </p>
      <p>
        <textarea
          name="body"
          placeholder="body"
          value={body}
          onChange={(e) => setBody(e.target.value)}
        ></textarea>
      </p>
      <p>
        <input type="submit" value="update" />
      </p>
    </form>
  );
};

export default UpdatePage;
```

<br>

ë³¸ë¬¸ì€ ìˆ˜ì •ì´ ì•ˆë¨ -> cache ë•Œë¬¸ì„

ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •

```js
// app > read > [id] > page.js
import React from "react";

const ReadPage = async (props) => {
  const res = await fetch(`http://localhost:9999/topics/${props.params.id}`, {
    cache: "no-store",
  });
  const topic = await res.json();
  return (
    <>
      <h2>{topic.title}</h2>
      <div> {topic.body}</div>
    </>
  );
};

export default ReadPage;
```

<br>

# 16. ê¸€ ì‚­ì œ

app/Control.js ìˆ˜ì •

```js
"use client";
import Link from "next/link";
import { useParams, useRouter } from "next/navigation";
import React from "react";

const Control = () => {
  const params = useParams();
  const router = useRouter();
  const id = params.id;
  return (
    <ul>
      <li>
        <Link href="/create">Create</Link>
      </li>
      {id ? (
        <>
          <li>
            <Link href={`/update/${id}`}>Update</Link>
          </li>
          <li>
            <input
              type="button"
              value="delete"
              onClick={() => {
                const options = { method: "DELETE" };
                fetch(`http://localhost:9999/topics/${id}`, options)
                  .then((res) => res.json())
                  .then((result) => {
                    // ì‚­ì œí•˜ë©´ rootë¡œ ë¦¬ë‹¤ì´ë ‰ì…˜
                    router.push("/");
                    router.refresh();
                  });
              }}
            ></input>
          </li>
        </>
      ) : null}
    </ul>
  );
};

export default Control;
```

<br>

# 17. í™˜ê²½ë³€ìˆ˜ & ì¡¸ì—…ğŸ‘©â€ğŸ“

> api ì£¼ì†Œê°€`http://localhost:9999/topics` ì´ë ‡ê²Œ localhostë¡œ í•˜ë“œì½”ë”©ë˜ì–´ìˆìŒ -> ê´€ë¦¬í•´ì•¼í•¨

- `.env.local` íŒŒì¼ì„ root ê²½ë¡œì— ë§Œë“¤ê³  ì¤‘ìš”í•œ ì •ë³´ë¥¼ ë‹´ì.
- `NEXT_PUBLIC` ì ‘ë‘ì‚¬ê°€ ì—†ìœ¼ë©´ server componentì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆê³ , client componentì—ì„œëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ -> DB_PASSWORDì™€ ê°™ì€ ë¹„ë°€ì •ë³´ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•œ ì•ˆì „ì¥ì¹˜
- ì›¹ ë¸Œë¼ìš°ì €ë¥¼ ìœ„í•œ í™˜ê²½ë³€ìˆ˜ë¥¼ ì“°ê³ ì‹¶ë‹¤ë©´ `NEXT_PUBLIC`ì„ ì ‘ë‘ì‚¬ë¡œ ë¶™ì—¬ì•¼ í•¨.

```env.local
NEXT_PUBLIC_API_URL=http://localhost:9999/
```

<br>

ì•„ë˜ì™€ ê°™ì´ ë³€ê²½

```js
const resp = await fetch(`${process.env.NEXT_PUBLIC_API_URL}topics/${id}`, {
```

ë°˜ì˜ì´ ì•ˆë˜ë©´ ì„œë²„ ê»ë‹¤ í‚¤ë©´ ë¨

<br>

tip) í˜‘ì—…ì„ ìœ„í•´ `.env.local.example` íŒŒì¼ì„ ë§Œë“¤ì.

- í˜‘ì—… í•  ë•Œ ë‹¤ë¥¸ ê°œë°œìë“¤ì´ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©ë˜ëŠ” í™˜ê²½ ë³€ìˆ˜ë¥¼ ì‰½ê²Œ í™•ì¸í•  ìˆ˜ ìˆìŒ(ìƒ˜í”Œë¡œì¨ì˜ ì—­í• )

<br>
