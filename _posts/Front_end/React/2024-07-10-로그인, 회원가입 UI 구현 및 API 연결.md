---
title: "[React] ë¡œê·¸ì¸, íšŒì›ê°€ì… UI êµ¬í˜„ ë° API ì—°ê²°"
categories: [React]
tag: [React]
toc_label: Contents
toc: true
toc_sticky: true
author_profile: true
sidebar:
  nav: "counts"
---

<br>

# 1. UI êµ¬í˜„

## 1.1 ë¡œê·¸ì¸, íšŒì›ê°€ì… UI êµ¬í˜„ ë° í† ê¸€ë§

ì•„ë˜ì™€ ê°™ì´ Login.jsxì—ì„œ ë¡œê·¸ì¸, íšŒì›ê°€ì… UIë¥¼ ëª¨ë‘ ë§Œë“¤ì–´ì£¼ì—ˆë‹¤.

<br>

ë¡œê·¸ì¸ì°½ì—ì„œëŠ” íšŒì›ê°€ì… ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ íšŒì›ê°€ì…ì°½ìœ¼ë¡œ, íšŒì›ê°€ì…ì°½ì—ì„œëŠ” ë¡œê·¸ì¸ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë¡œê·¸ì¸ì°½ìœ¼ë¡œ í† ê¸€ë§ ë˜ë„ë¡ êµ¬í˜„í•˜ì˜€ë‹¤.

```js
// src > pages > Login.jsx
import { useState } from "react";
import styled from "styled-components";

const Login = () => {
  const [isLoginMode, setIsLoginMode] = useState(true);
  return (
    <LoginContainer>
      <LoginFormBox>
        <LoginTitle>{isLoginMode ? "ë¡œê·¸ì¸" : "íšŒì›ê°€ì…"}</LoginTitle>

        <input
          placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. (4~10ê¸€ì)"
          minLength={4}
          maxLength={10}
        />
        <input
          placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. (4~15ê¸€ì)"
          minLength={4}
          maxLength={15}
        />
        {!isLoginMode && (
          <input
            placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (1~10ê¸€ì)"
            minLength={1}
            maxLength={10}
          />
        )}
        <LoginButton>{isLoginMode ? "ë¡œê·¸ì¸" : "íšŒì›ê°€ì…"}</LoginButton>
        <LoginToggleButton>
          <span onClick={() => setIsLoginMode((prev) => !prev)}>
            {isLoginMode ? "íšŒì›ê°€ì…" : "ë¡œê·¸ì¸"}
          </span>
        </LoginToggleButton>
      </LoginFormBox>
    </LoginContainer>
  );
};
```

<br>

## 1.2 ì…ë ¥ ê°’ì´ ìˆì„ ê²½ìš°ë§Œ ë²„íŠ¼ í™œì„±í™”

1. ì…ë ¥ ê°’ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ formStateë¼ëŠ” state ìƒì„±.
2. formStateë¥¼ êµ¬ì¡° ë¶„í•´ í• ë‹¹
3. inputì— ê°ê° nameê³¼ valueì„ ì •ì˜í•´ì¤€ í›„ onChangHandlerë¼ëŠ” í•¨ìˆ˜ë¥¼ í• ë‹¹í•˜ê¸°

```js
import { useState } from "react";
import styled from "styled-components";

const Login = () => {
  const [isLoginMode, setIsLoginMode] = useState(true);

  const [formState, setFormState] = useState({
    id: "",
    password: "",
    nickname: "",
  });
  const { id, password, nickname } = formState;

  const onChangeHandler = (evnet) => {
    // evnet.targetì€ input "íƒœê·¸" ë¥¼ ê°€ë¦¬í‚´
    // nameê³¼ valueë¥¼ êµ¬ì¡° ë¶„í•´ í• ë‹¹ input íƒœê·¸ì˜ ì´ë¦„ê³¼ ì…ë ¥í•œ ê°’ì„ ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•¨
    const { name, value } = evnet.target;
    setFormState((prev) => ({ ...prev, [name]: value }));
  };

  return (
    <LoginContainer>
      <LoginFormBox>
        <LoginTitle>{isLoginMode ? "ë¡œê·¸ì¸" : "íšŒì›ê°€ì…"}</LoginTitle>
        <input
          name="id"
          value={id}
          onChange={onChangeHandler}
          placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. (4~10ê¸€ì)"
          minLength={4}
          maxLength={10}
        />
        <input
          name="password"
          value={password}
          onChange={onChangeHandler}
          placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. (4~15ê¸€ì)"
          minLength={4}
          maxLength={15}
        />
        {!isLoginMode && (
          <input
            name="nickname"
            value={nickname}
            onChange={onChangeHandler}
            placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (1~10ê¸€ì)"
            minLength={1}
            maxLength={10}
          />
        )}
        <LoginButton>{isLoginMode ? "ë¡œê·¸ì¸" : "íšŒì›ê°€ì…"}</LoginButton>
        <LoginToggleButton>
          <span onClick={() => setIsLoginMode((prev) => !prev)}>
            {isLoginMode ? "íšŒì›ê°€ì…" : "ë¡œê·¸ì¸"}
          </span>
        </LoginToggleButton>
      </LoginFormBox>
    </LoginContainer>
  );
};
```

<br>

ê·¸ í›„, disabled propì„ ì‚¬ìš©í•˜ì—¬ ë¡œê·¸ì¸í™”ë©´ì—ì„œëŠ” ì•„ì´ë””, ë¹„ë°€ë²ˆí˜¸ì— ì…ë ¥ ê°’ì´ ëª¨ë‘ ìˆì„ ê²½ìš°ì—ë§Œ ë¡œê·¸ì¸ ë²„íŠ¼ì´ í™œì„±í™”ë˜ë„ë¡ í•˜ê³ , íšŒì›ê°€ì…í™”ë©´ì—ì„œëŠ” ì•„ì´ë””, ë¹„ë°€ë²ˆí˜¸, ë‹‰ë„¤ì„ì— ì…ë ¥ ê°’ì´ ìˆì„ ê²½ìš°ì—ë§Œ íšŒì›ê°€ì… ë²„íŠ¼ì´ í™œì„±í™”ë˜ë„ë¡ í•˜ì˜€ë‹¤.

```js
<LoginButton
  disabled={isLoginMode ? !id || !password : !id || !password || !nickname}
>
  {isLoginMode ? "ë¡œê·¸ì¸" : "íšŒì›ê°€ì…"}
</LoginButton>;

const LoginButton = styled.button`
  color: white;
  cursor: pointer;
  margin-top: 14px;
  padding: 10px;

  ${(props) => {
    if (props.disabled) {
      return css`
        background-color: lightgary;
      `;
    }
    return css`
      background-color: black;
    `;
  }}
`;
```

<br>

## 1.3 redux ëª¨ë“ˆë¡œ ë¡œê·¸ì¸ ìƒíƒœë¥¼ ì „ì—­ ìƒíƒœë¡œ ê´€ë¦¬í•˜ê¸°

redux ëª¨ë“ˆë¡œ authSlice.js ë¥¼ ë§Œë“¤ê³  ë¡œê·¸ì¸ ìƒíƒœë¥¼ ì „ì—­ ìƒíƒœë¡œ ê´€ë¦¬í•´ë³´ì

ì¦‰, ì§€ê¸ˆ í•˜ë ¤ê³  í•˜ëŠ”ê±´ ì§€ì—­ ìƒíƒœë¡œ ê´€ë¦¬ë˜ê³  ìˆëŠ” isLogin stateë¥¼ ì „ì—­ ìƒíƒœë¡œ ë³€ê²½í•˜ëŠ” ì‘ì—…ì„ í•  ê²ƒì´ë‹¤.

<br>

authSlice.js ìƒì„±!

```js
// src > redux > modules > authSlice.js
import { createSlice } from "@reduxjs/toolkit";

const initialState = {
  isLogin: false,
};

const authSlice = createSlice({
  name: "auth",
  initialState,
  reducers: {
    login: (state, action) => {
      state.isLogin = true;
    },
    logout: (state, action) => {
      state.isLogin = false;
    },
  },
});

export const { login, logout } = authSlice.actions;
export default authSlice.reducer;
```

<br>

ê·¸ í›„ storeì— ì—°ê²°í•˜ê¸°!

```js
import letters from "store/modules/letterSlice";
import activeTab from "store/modules/activeTabSlice";
import auth from "store/modules/authSlice";

import { combineReducers, configureStore } from "@reduxjs/toolkit";

const rootReducer = combineReducers({ letters, activeTab, auth });

const store = configureStore({ reducer: rootReducer });

export default store;
```

<br>

ë¡œê·¸ì¸ ì„±ê³µí–ˆì„ ê²½ìš°, ë¡œê·¸ì¸ ìƒíƒœë¥¼ ë³€ê²½ì‹œì¼œ í™ˆí™”ë©´ìœ¼ë¡œ ì´ë™ë˜ë„ë¡ í•´ë³´ì.<br>
Router.jsxì— ì´ë™í•´ì„œ useStateë¡œ êµ¬ë…ì¤‘ì´ë˜ ê²ƒì„ useSelectorë¥¼ ì‚¬ìš©í•˜ì—¬ stateì— `state.auth.isLogin`ì„ êµ¬ë…í•˜ë„ë¡ ë³€ê²½í•˜ì.

```js
// src > shared > Router.jsx
const Router = () => {
  // const [isLogin, setIsLogin] = useState(false);
  const isLogin = useSelector((state) => state.auth.isLogin);
```

<br>

ë¡œê·¸ì¸ ì²˜ë¦¬ê°€ ì˜ ë˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ dispathë¥¼ ë‚ ë ¤ ë¡œê·¸ì¸ì´ ì„±ê³µí•˜ë©´ isLogin stateë¥¼ trueë¡œ ë³€ê²½í•´ë³´ì.<br>
ë˜í•œ íšŒì›ê°€ì…ì— ì„±ê³µí•˜ë©´ ë¡œê·¸ì¸ ëª¨ë“œë¡œ ì „í™˜í•˜ì.

```js
// src > pages > Login.jsx
import { useState } from "react";
import { useDispatch } from "react-redux";
import { login } from "store/modules/authSlice";
import styled, { css } from "styled-components";

const Login = () => {
  const dispatch = useDispatch(); // useDispatch() ìƒì„±

  const [isLoginMode, setIsLoginMode] = useState(true);
  const [formState, setFormState] = useState({
    id: "",
    password: "",
    nickname: "",
  });
  const { id, password, nickname } = formState;

  const onChangeHandler = (event) => {
    const { name, value } = event.target;
    setFormState((prev) => ({ ...prev, [name]: value }));
  };

  // isLoginMode ìƒíƒœì— ë”°ë¼ ë¡œê·¸ì¸ ë˜ëŠ” íšŒì›ê°€ì… ì²˜ë¦¬ë¥¼ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜
  const onSubmitHandler = (event) => {
    event.preventDefault();
    if (isLoginMode) {
      // ë¡œê·¸ì¸ ì²˜ë¦¬
      dispatch(login());
      alert("ë¡œê·¸ì¸ ì„±ê³µ");
    } else {
      // íšŒì›ê°€ì… ì²˜ë¦¬
      setIsLoginMode(true);
      alert("íšŒì›ê°€ì… ì„±ê³µ");
    }
  };

  return (
    <LoginContainer>
      <LoginFormBox onSubmit={onSubmitHandler}>
        <LoginTitle>{isLoginMode ? "ë¡œê·¸ì¸" : "íšŒì›ê°€ì…"}</LoginTitle>
        <input
          name="id"
          value={id}
          onChange={onChangeHandler}
          placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. (4~10ê¸€ì)"
          minLength={4}
          maxLength={10}
        />
        <input
          name="password"
          value={password}
          onChange={onChangeHandler}
          placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. (4~15ê¸€ì)"
          minLength={4}
          maxLength={15}
        />
        {!isLoginMode && (
          <input
            name="nickname"
            value={nickname}
            onChange={onChangeHandler}
            placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (1~10ê¸€ì)"
            minLength={1}
            maxLength={10}
          />
        )}

        <LoginButton
          disabled={
            isLoginMode ? !id || !password : !id || !password || !nickname
          }
        >
          {isLoginMode ? "ë¡œê·¸ì¸" : "íšŒì›ê°€ì…"}
        </LoginButton>
        <LoginToggleButton>
          <span onClick={() => setIsLoginMode((prev) => !prev)}>
            {isLoginMode ? "íšŒì›ê°€ì…" : "ë¡œê·¸ì¸"}
          </span>
        </LoginToggleButton>
      </LoginFormBox>
    </LoginContainer>
  );
};
```

<br>

## 1.4 form ì œì¶œ í›„ input ì´ˆê¸°í™”

form ì œì¶œ í›„ inputì„ ì´ˆê¸°í™”ë¥¼ ìœ„í•´ ì•„ë˜ì™€ ê°™ì´ ë³€ê²½í•´ì£¼ì

```js
const Login = () => {
  const dispatch = useDispatch();

  const [isLoginMode, setIsLoginMode] = useState(true);
  const [formState, setFormState] = useState({
    id: '',
    password: '',
    nickname: ''
  });
  const { id, password, nickname } = formState;

  const onChangeHandler = (event) => {
    const { name, value } = event.target;
    setFormState((prev) => ({ ...prev, [name]: value }));
  };


  const onSubmitHandler = (event) => {
    event.preventDefault();
    if (isLoginMode) {
      // ë¡œê·¸ì¸ ì²˜ë¦¬
      dispatch(login());
      alert('ë¡œê·¸ì¸ ì„±ê³µ');
    } else {
      // íšŒì›ê°€ì… ì²˜ë¦¬
      setIsLoginMode(true);

      // setFormStateë¡œ ì´ˆê¸°í™”
      setFormState({
        id: '',
        password: '',
        nickname: ''
      });
      alert('íšŒì›ê°€ì… ì„±ê³µ');
    }
  };
```

<br>

ì¤‘ë³µëœ ê¸´ ì½”ë“œë¥¼ ë‘ ë²ˆ ì„ ì–¸í•˜ëŠ” ê²ƒì€ ë„ˆë¬´ ë¹„íš¨ìœ¨ì ì¸ ê²ƒ ê°™ì•„ initialStateë¥¼ ìƒì„±í•˜ì˜€ë‹¤.

```js
import { useState } from 'react';
import { useDispatch } from 'react-redux';
import { login } from 'store/modules/authSlice';
import styled, { css } from 'styled-components';

const Login = () => {
  const dispatch = useDispatch();

  const [isLoginMode, setIsLoginMode] = useState(true);
  const initialState = {
    id: '',
    password: '',
    nickname: ''
  };
  const [formState, setFormState] = useState(initialState);
  const { id, password, nickname } = formState;

  const onChangeHandler = (event) => {
    const { name, value } = event.target;
    setFormState((prev) => ({ ...prev, [name]: value }));
  };

  const onSubmitHandler = (event) => {
    event.preventDefault();
    if (isLoginMode) {
      // ë¡œê·¸ì¸ ì²˜ë¦¬
      dispatch(login());
      alert('ë¡œê·¸ì¸ ì„±ê³µ');
    } else {
      // íšŒì›ê°€ì… ì²˜ë¦¬
      setIsLoginMode(true);

      // setFormStateë¡œ ì´ˆê¸°í™”
      setFormState(initialState);
      alert('íšŒì›ê°€ì… ì„±ê³µ');
    }
  };

```

<br>

## 1.4.1 íŠ¸ëŸ¬ë¸” ìŠˆíŒ…ğŸ’«

> ë°œìƒí•œ ë¬¸ì œ ğŸ¤¦â€â™€ï¸

isLoginModeì˜ stateê°€ trueì¼ ë•Œ, íšŒì›ê°€ì… ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ stateê°€ falseë¡œ ì „í™˜ë˜ì§€ ì•Šì•„ í† ê¸€ ë²„íŠ¼ì´ ì‘ë™í•˜ì§€ ì•Šê³ , ë¬´ì¡°ê±´ íšŒì› ê°€ì…ì´ ì„±ê³µí–ˆë‹¤ëŠ” alert ì°½ì´ ëœ¨ëŠ” ë¬¸ì œê°€ ìˆì—ˆë‹¤.

```js
return (
  <LoginToggleButton>
    <span onClick={() => setIsLoginMode((prev) => !prev)}>
      {isLoginMode ? "íšŒì›ê°€ì…" : "ë¡œê·¸ì¸"}
    </span>
  </LoginToggleButton>
);

const LoginToggleButton = styled.button``;
```

<br>

> ë¬¸ì œ ì›ì¸ ğŸ¤·â€â™€ï¸

ë²„íŠ¼ì€ ê¸°ë³¸ì ìœ¼ë¡œ í´ë¦­ë˜ë©´ form íƒœê·¸ì˜ submit ë™ì‘ì„ ìˆ˜í–‰í•œë‹¤.

ë”°ë¼ì„œ "íšŒì›ê°€ì…" ë²„íŠ¼ í´ë¦­ì‹œ í¼ ì œì¶œ ë™ì‘ì„ ìë™ìœ¼ë¡œ ìˆ˜í–‰í•˜ì—¬ stateê°€ falseë¡œ ì „í™˜ë˜ì§€ ì•Šì•„ í† ê¸€ ë²„íŠ¼ì´ ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•Šì€ ê²ƒì´ë‹¤.

<br>

> í•´ê²° ë°©ì•ˆ ğŸ’â€â™€ï¸

ë²„íŠ¼ ëŒ€ì‹  div íƒœê·¸ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ í´ë¦­ ì‹œ í¼ ì œì¶œ ë™ì‘ì´ ë°œìƒí•˜ì§€ ì•Šì•„ ìƒíƒœê°€ ì˜¬ë°”ë¥´ê²Œ ì „í™˜ë˜ê³ , í† ê¸€ ë²„íŠ¼ì´ ì œëŒ€ë¡œ ì‘ë™í•˜ë„ë¡ ë¬¸ì œë¥¼ í•´ê²°í•˜ì˜€ë‹¤.

```js
return (
  <LoginToggleBox>
    <span onClick={() => setIsLoginMode((prev) => !prev)}>
      {isLoginMode ? "íšŒì›ê°€ì…" : "ë¡œê·¸ì¸"}
    </span>
  </LoginToggleBox>
);

const LoginToggleBox = styled.div``;
```

<br><br>

## 1.5 react-toastify ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©í•˜ê¸°

ë¡œê·¸ì¸ ì„±ê³µì´ë‚˜ íšŒì›ê°€ì… ì„±ê³µ ì‹œ ë¸Œë¼ìš°ì € alert ëŒ€ì‹  react-toastify ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ë³´ì.

ê³µì‹ ë¬¸ì„œ : https://fkhadra.github.io/react-toastify/installation

<br>

ì„¤ì¹˜í•˜ê¸°

```
yarn add react-toastify
```

<br>

ì„¤ì¹˜ í›„, ìµœìƒìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ToastContainerì„ í˜¸ì¶œí•˜ì.

```js
// src > index.jsx
import React from "react";
import ReactDOM from "react-dom/client";
import App from "./App";
import GlobalStyle from "styles/GlobalStyle";
import { Provider } from "react-redux";
import store from "store/config/configStore";

// import
import { ToastContainer } from "react-toastify";
import "react-toastify/dist/ReactToastify.css";

const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(
  <Provider store={store}>
    <App />
    <GlobalStyle />
    <ToastContainer />
  </Provider>
);
```

<br>

ê·¸ë¦¬ê³  ì•„ë˜ì™€ ê°™ì´ í˜¸ì¶œí•˜ì

```js
// src > pages > Login.jsx
import { toast } from "react-toastify";
const Login = () => {
  const onSubmitHandler = (event) => {
    event.preventDefault();
    if (isLoginMode) {
      // ë¡œê·¸ì¸ ì²˜ë¦¬
      dispatch(login());
      // alert('ë¡œê·¸ì¸ ì„±ê³µ');
      toast.success("ë¡œê·¸ì¸ ì„±ê³µ");
    } else {
      // íšŒì›ê°€ì… ì²˜ë¦¬
      setIsLoginMode(true);
      setFormState(initialState);
      // alert('íšŒì›ê°€ì… ì„±ê³µ');
      toast.success("íšŒì›ê°€ì… ì„±ê³µ");
    }
  };
};
```

## 1.6 ì»¤ìŠ¤í…€ í›… ë§Œë“¤ê¸°

Login.jsxì— ìˆëŠ” ì•„ë˜ ì½”ë“œë¥¼ ì»¤ìŠ¤í…€ í›…ìœ¼ë¡œ ë§Œë“¤ì–´ë³´ì

```js
// src > pages > Login.jsx
const initialState = {
  id: "",
  password: "",
  nickname: "",
};

const [formState, setFormState] = useState(initialState);

const onChangeHandler = (event) => {
  const { name, value } = event.target;
  setFormState((prev) => ({ ...prev, [name]: value }));
};

const onSubmitHandler = (event) => {
  if (isLoginMode) {
    ...
  } else {
    ...
    setFormState(initialState);
  }
};
```

<br>

useForm.js ìƒì„± í›„ ì»¤ìŠ¤í…€ í›…ì„ ë§Œë“¤ì–´ë³´ì!

```js
// src > gooks > useForm.js
const { useState } = require("react");

const useForm = (initialState = {}) => {
  const [formState, setFormState] = useState(initialState);
  const onChangeHandler = (event) => {
    const { name, value } = event.target;
    setFormState((prev) => ({ ...prev, [name]: value }));
  };
  const resetForm = () => {
    setFormState(initialState);
  };

  return { formState, onChangeHandler, resetForm };
};

export default useForm;
```

<br>

ì»¤ìŠ¤í…€ í›…ì„ ë§Œë“¤ì—ˆìœ¼ë‹ˆ ì‚¬ìš©í•˜ê¸°!

```js
import { useState } from 'react';
import { useDispatch } from 'react-redux';
import { login } from 'store/modules/authSlice';
import styled, { css } from 'styled-components';
import { toast } from 'react-toastify';
import useForm from 'hooks/useForm';

const Login = () => {
  const dispatch = useDispatch(); // useDispatch() ìƒì„±

  const [isLoginMode, setIsLoginMode] = useState(true);
  // const initialState = {
  //   id: '',
  //   password: '',
  //   nickname: ''
  // };
  // const [formState, setFormState] = useState(initialState);
  const { formState, onChangeHandler, resetForm } = useForm({ id: '', password: '', nickname: '' });
  const { id, password, nickname } = formState;

  // const onChangeHandler = (event) => {
  //   const { name, value } = event.target;
  //   setFormState((prev) => ({ ...prev, [name]: value }));
  // };

  const onSubmitHandler = (event) => {
    event.preventDefault();
    if (isLoginMode) {
      // ë¡œê·¸ì¸ ì²˜ë¦¬
      dispatch(login());
      toast.success('ë¡œê·¸ì¸ ì„±ê³µ');
    } else {
      // íšŒì›ê°€ì… ì²˜ë¦¬
      setIsLoginMode(true);
      // setFormState(initialState);
      resetForm();
      toast.success('íšŒì›ê°€ì… ì„±ê³µ');
    }
  };
```

<br><br>

# 2. íšŒì›ê°€ì… / ë¡œê·¸ì¸ API ì—°ê²°

ë¡œê·¸ì¸ê³¼ íšŒì›ê°€ì… APIëŠ” JWT ì¸ì¦ì„œë²„ë¥¼ ì‚¬ìš©í•  ê²ƒì´ë‹¤.

<br>

## 2.1 íšŒì›ê°€ì… API ì—°ê²°

API ìš”ì²­ì„ fetchê°€ ì•„ë‹Œ axios ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì•„ë˜ì™€ ê°™ì´ axiosë¥¼ ì„¤ì¹˜í•´ì£¼ì

```
yarn add axios
```

<br>

ê·¸ í›„, [[API ë¬¸ì„œ] ](https://mynamesieun.github.io/react/Thunder-Client%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%ED%86%B5%EC%8B%A0-%EC%97%B0%EC%8A%B5/)ë¥¼ ì°¸ê³ í•´ì„œ íšŒì›ê°€ì… APIë¥¼ ì—°ê²°í•˜ì.

```js
// src > pages > Login
const onSubmitHandler = (event) => {
  event.preventDefault();
  if (isLoginMode) {
    // ë¡œê·¸ì¸ ì²˜ë¦¬
    dispatch(login());
    toast.success("ë¡œê·¸ì¸ ì„±ê³µ");
  } else {
    // íšŒì›ê°€ì… ì²˜ë¦¬
    axios.post("https://moneyfulpublicpolicy.co.kr/register", {
      id,
      password,
      nickname,
    });
    setIsLoginMode(true);
    resetForm();
    toast.success("íšŒì›ê°€ì… ì„±ê³µ");
  }
};
```

<br>

ì„œë²„ì˜ ìš”ì²­í•˜ëŠ” ëª¨ë“  ë™ì‘ì€ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‘ë™í•˜ê¸° ë•Œë¬¸ì— ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ ë™ê¸°ì ìœ¼ë¡œ ë³€í™˜í•´ì£¼ê¸° ìœ„í•´ async, awiteë¥¼ ì‚¬ìš©í•˜ì

```js
// src > pages > Login
const onSubmitHandler = async (event) => {
  event.preventDefault();
  if (isLoginMode) {
    // ë¡œê·¸ì¸ ì²˜ë¦¬
    dispatch(login());
    toast.success("ë¡œê·¸ì¸ ì„±ê³µ");
  } else {
    // íšŒì›ê°€ì… ì²˜ë¦¬
    const result = await axios.post(
      "https://moneyfulpublicpolicy.co.kr/register",
      {
        id,
        password,
        nickname,
      }
    );
    console.log("result : ", result);
    setIsLoginMode(true);
    resetForm();
    toast.success("íšŒì›ê°€ì… ì„±ê³µ");
  }
};
```

resultëŠ” 8ê°œì˜ í”„ë¡œí¼í‹°ë¥¼ ê°€ì§„ ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

<br>

ìš°ë¦¬ê°€ ê´€ì‹¬ìˆëŠ” ê²ƒì€ data í”„ë¡œí¼í‹°ì´ë‹¤. ë”°ë¼ì„œ êµ¬ì¡° ë¶„í•´ í• ë‹¹ìœ¼ë¡œ dataë¥¼ ë½‘ì•„ë‚´ì–´ dataì˜ successê°€ trueì¸ ê²½ìš°ì˜ ë¡œì§ì„ ë”°ë¡œ ì²˜ë¦¬í•´ì£¼ì.

```js
const onSubmitHandler = async (event) => {
  event.preventDefault();
  if (isLoginMode) {
    // ë¡œê·¸ì¸ ì²˜ë¦¬
    dispatch(login());
    toast.success("ë¡œê·¸ì¸ ì„±ê³µ");
  } else {
    // íšŒì›ê°€ì… ì²˜ë¦¬
    const { data } = await axios.post(
      "https://moneyfulpublicpolicy.co.kr/register",
      {
        id,
        password,
        nickname,
      }
    );
    if (data.success) {
      setIsLoginMode(true);
      resetForm();
      toast.success("íšŒì›ê°€ì… ì„±ê³µ");
    }
  }
};
```

<br>

axiosë¡œ ì„œë²„ì— ìš”ì²­ì„ ë³´ëƒˆì„ ë•Œ ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ try~catchë¬¸ ì„ í†µí•´ ì˜ˆì™¸ì²˜ë¦¬ë¥¼ í•˜ì.

```js
const onSubmitHandler = async (event) => {
  event.preventDefault();
  if (isLoginMode) {
    // ë¡œê·¸ì¸ ì²˜ë¦¬
    dispatch(login());
    toast.success("ë¡œê·¸ì¸ ì„±ê³µ");
  } else {
    try {
      // íšŒì›ê°€ì… ì²˜ë¦¬
      const { data } = await axios.post(
        "https://moneyfulpublicpolicy.co.kr/register",
        {
          id,
          password,
          nickname,
        }
      );
      if (data.success) {
        setIsLoginMode(true);
        resetForm();
        toast.success("íšŒì›ê°€ì… ì„±ê³µ");
      }
    } catch (err) {
      console.log("ì—ëŸ¬");
      toast.error(err.response.data.message);
    }
  }
};
```

<br>

<br><br>

# 3. accessToken ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•˜ê¸°

ì„œë²„ì—ì„œ ì‘ë‹µ ë°›ì€ data ì•ˆì— ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ê°€ ë“¤ì–´ìˆë‹¤.

ë¡œê·¸ì¸ì— ì„±ê³µí•˜ë©´ ì„œë²„ ì‘ë‹µìœ¼ë¡œ ë°›ì€ accessToken ì„ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•˜ì.

```js
  const onSubmitHandler = async (event) => {
    event.preventDefault();
    if (isLoginMode) {
      // ë¡œê·¸ì¸ ì²˜ë¦¬
      try {
        const { data } = await axios.post('https://moneyfulpublicpolicy.co.kr/login', {
          id,
          password
        });
        if (data.success) {
          localStorage.setItem('accessToken', data.accessToken);
          dispatch(login());
          toast.success('ë¡œê·¸ì¸ ì„±ê³µ');
        }
      } catch (err) {
        toast.error(err.response.data.message);
      }
    }
    ...
```

<br>

ì•„ë˜ì²˜ëŸ¼ ì‘ì„±í•œ ì½”ë“œë¥¼ ë¦¬ë•ìŠ¤ì—ê²Œ ìœ„ì„ ì‹œì¼œë³´ì.

```js
if (data.success) {
  localStorage.setItem("accessToken", data.accessToken);
  dispatch(login());
  toast.success("ë¡œê·¸ì¸ ì„±ê³µ");
}
```

<br>

payloadë¡œ ì—‘ì„¸ìŠ¤ í† í° ë„˜ê²¨ì£¼ê¸°!

```js
if (data.success) {
  dispatch(login(data.accessToken));
  toast.success("ë¡œê·¸ì¸ ì„±ê³µ");
}
```

ê·¸ë¦¬ê³  ë¦¬ë“€ì„œì— ì ìš©í•˜ì.

```js
// src > redux > modules > authSlice.js
import { createSlice } from "@reduxjs/toolkit";

const initialState = {
  // í† í°ì„ ì €ì¥í•œ ê²ƒì´ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ë‚¨ì•„ìˆë‹¤ë©´, isLoginì€ true
  isLogin: !!localStorage.getItem("accessToken"),
};

const authSlice = createSlice({
  name: "auth",
  initialState,
  reducers: {
    login: (state, action) => {
      // accessTokenë¥¼ localStorage ì•ˆì— ì ìš©
      const accessToken = action.payload;
      localStorage.setItem("accessToken", accessToken);
      state.isLogin = true;
    },
    logout: (state, action) => {
      state.isLogin = false;

      // ë¡œê·¸ì•„ì›ƒ ì‹œ ëª¨ë“  ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ìˆëŠ” ë‚´ìš© ì‚­ì œ
      localStorage.clear();
    },
  },
});

export const { login, logout } = authSlice.actions;
export default authSlice.reducer;
```

!! ì€ typeì„ ë¶ˆë¦¬ì–¸ íƒ€ì…ìœ¼ë¡œ ê°•ì œ ë³€í™˜ì‹œí‚¤ëŠ” ì—°ì‚°ìì´ë‹¤.

<br>

ë¡œì»¬ìŠ¤í† ë¦¬ì§€ë¥¼ ì‚¬ìš©í–ˆìœ¼ë‹ˆ ìƒˆë¡œê³ ì¹¨ì‹œì—ë„ ë¡œê·¸ì¸ ìƒíƒœê°€ ìœ ì§€ëœë‹¤!

<br>

í˜„ì¬ê¹Œì§€ ì „ì²´ ì½”ë“œ!

```js
// src > pages > Login.jsx
import { useState } from "react";
import { useDispatch } from "react-redux";
import { login } from "store/modules/authSlice";
import styled, { css } from "styled-components";
import { toast } from "react-toastify";
import useForm from "hooks/useForm";
import axios from "axios";

const Login = () => {
  const dispatch = useDispatch();

  const [isLoginMode, setIsLoginMode] = useState(true);

  const { formState, onChangeHandler, resetForm } = useForm({
    id: "",
    password: "",
    nickname: "",
  });
  const { id, password, nickname } = formState;

  const onSubmitHandler = async (event) => {
    event.preventDefault();
    if (isLoginMode) {
      // ë¡œê·¸ì¸ ì²˜ë¦¬
      try {
        const { data } = await axios.post(
          "https://moneyfulpublicpolicy.co.kr/login",
          {
            id,
            password,
          }
        );
        if (data.success) {
          dispatch(login(data.accessToken));
          toast.success("ë¡œê·¸ì¸ ì„±ê³µ");
        }
      } catch (err) {
        toast.error(err.response.data.message);
      }
    } else {
      try {
        // íšŒì›ê°€ì… ì²˜ë¦¬
        const { data } = await axios.post(
          "https://moneyfulpublicpolicy.co.kr/register",
          {
            id,
            password,
            nickname,
          }
        );
        if (data.success) {
          setIsLoginMode(true);
          resetForm();
          toast.success("íšŒì›ê°€ì… ì„±ê³µ");
        }
      } catch (err) {
        toast.error(err.response.data.message);
      }
    }
  };

  return (
    <LoginContainer>
      <LoginFormBox onSubmit={onSubmitHandler}>
        <LoginTitle>{isLoginMode ? "ë¡œê·¸ì¸" : "íšŒì›ê°€ì…"}</LoginTitle>
        <input
          name="id"
          value={id}
          onChange={onChangeHandler}
          placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. (4~10ê¸€ì)"
          minLength={4}
          maxLength={10}
        />
        <input
          name="password"
          value={password}
          onChange={onChangeHandler}
          placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. (4~15ê¸€ì)"
          minLength={4}
          maxLength={15}
        />
        {!isLoginMode && (
          <input
            name="nickname"
            value={nickname}
            onChange={onChangeHandler}
            placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (1~10ê¸€ì)"
            minLength={1}
            maxLength={10}
          />
        )}
        <LoginButton
          disabled={
            isLoginMode ? !id || !password : !id || !password || !nickname
          }
        >
          {isLoginMode ? "ë¡œê·¸ì¸" : "íšŒì›ê°€ì…"}
        </LoginButton>
        <LoginToggleBox>
          <span onClick={() => setIsLoginMode((prev) => !prev)}>
            {isLoginMode ? "íšŒì›ê°€ì…" : "ë¡œê·¸ì¸"}
          </span>
        </LoginToggleBox>
      </LoginFormBox>
    </LoginContainer>
  );
};
```

<br><br>

# 4. axios interceptor ì‚¬ìš©í•˜ê¸°

axios interceptorì„ ì‚¬ìš©í•˜ë©´ baseUrlì„ ì¼ì¼íˆ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.

src > api > index.js ë¼ëŠ” í´ë”ë¥¼ ë§Œë“¤ì–´ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•˜ì.

```js
// src > api > index.js
import axios from "axios";

export const authApi = axios.create({
  baseURL: "https://moneyfulpublicpolicy.co.kr",
  headers: {
    "Content-Type": "application/json",
  },
});
```

ì—ëŸ¬ ë‚˜ë©´ import ì œëŒ€ë¡œ ëë‚˜ í™•ì¸í•˜ê¸°!

<br>

ê·¸ í›„ axios ëŒ€ì‹ ì— authApi ë¶ˆëŸ¬ì˜¤ì.

authApi ì•ˆì— baseUrlì´ ë“¤ì–´ìˆê¸° ë•Œë¬¸ì— ì§€ì›Œë„ ëœë‹¤.

```js
import { authApi } from "api";

  const onSubmitHandler = async (event) => {
    event.preventDefault();
    if (isLoginMode) {
      // ë¡œê·¸ì¸ ì²˜ë¦¬
      try {
        const { data } = await authApi.post("/login", {
          id,
          password,
        });
        if (data.success) {
          dispatch(login(data.accessToken));
          toast.success("ë¡œê·¸ì¸ ì„±ê³µ");
        }
      } catch (err) {
        toast.error(err.response.data.message);
      }
    } else {
      try {
        // íšŒì›ê°€ì… ì²˜ë¦¬
        const { data } = await authApi.post("/register", {
          id,
          password,
          nickname,
        });
        if (data.success) {
          setIsLoginMode(true);
          resetForm();
          toast.success("íšŒì›ê°€ì… ì„±ê³µ");
        }
      } catch (err) {
        toast.error(err.response.data.message);
      }
    }
  };

  return (
    <LoginContainer>
      <LoginFormBox onSubmit={onSubmitHandler}>
        <LoginTitle>{isLoginMode ? "ë¡œê·¸ì¸" : "íšŒì›ê°€ì…"}</LoginTitle>
        <input
          name="id"
          value={id}
          onChange={onChangeHandler}
          placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. (4~10ê¸€ì)"
          minLength={4}
          maxLength={10}
        />
        <input
          name="password"
          value={password}
          onChange={onChangeHandler}
          placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. (4~15ê¸€ì)"
          minLength={4}
          maxLength={15}
        />
        {!isLoginMode && (
          <input
            name="nickname"
            value={nickname}
            onChange={onChangeHandler}
            placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (1~10ê¸€ì)"
            minLength={1}
            maxLength={10}
          />
        )}
        <LoginButton
          disabled={
            isLoginMode ? !id || !password : !id || !password || !nickname
          }
        >
          {isLoginMode ? "ë¡œê·¸ì¸" : "íšŒì›ê°€ì…"}
        </LoginButton>
        <LoginToggleBox>
          <span onClick={() => setIsLoginMode((prev) => !prev)}>
            {isLoginMode ? "íšŒì›ê°€ì…" : "ë¡œê·¸ì¸"}
          </span>
        </LoginToggleBox>
      </LoginFormBox>
    </LoginContainer>
  );
};
```

<br><br>

# 5. login, loout router ì²˜ë¦¬

## 5.1 Layout.jsx ì»´í¬ë„ŒíŠ¸ ì‘ì„±í•˜ê¸°

ë¡œê·¸ì¸ì— ì„±ê³µí–ˆì„ ê²½ìš°, í™”ë©´ ìµœìƒë‹¨ì— í˜ì´ì§€ ì´ë™ì„ ìœ„í•œ Navigation Barë¥¼ ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ Layout.jsx ì»´í¬ë„ŒíŠ¸ë¥¼ ì‘ì„±í•˜ì

Layout ì»´í¬ë„ŒíŠ¸ëŠ” Router.jsx ì•ˆì—ì„œ ë¡œê·¸ì¸ ë˜ì—ˆì„ ê²½ìš°ì—ë§Œ ì ìš©ë˜ë„ë¡ í•˜ê¸° ìœ„í•´ Outlet ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.

```js
// src > components > Layout.jsx
import { Link, Outlet } from "react-router-dom";
import styled from "styled-components";

export const Layout = () => {
  return (
    <>
      <NavbarList>
        <Link to="/">For You</Link>
        <div>
          <Link to="/profile">ë‚´ í”„ë¡œí•„</Link>
          <Link>ë¡œê·¸ì•„ì›ƒ</Link>
        </div>
      </NavbarList>
      <Outlet />
    </>
  );
};

const NavbarList = styled.ul`
  margin: 0 auto;
  display: flex;
  max-width: 1200px;
  justify-content: space-between;
  height: 6rem;
  font-size: 24px;
  font-weight: bold;
  align-items: center;
  user-select: none;

  & a:hover {
    background-color: pink;
  }

  & div a:nth-child(2) {
    margin-left: 30px;
  }
`;
```

<br>

Route ì»´í¬ë„ŒíŠ¸ì— Layoutì„ ì‘ì„±í•˜ì—¬ ìì‹ Routeë¥¼ ê°ì‹¸ì£¼ì.

Routeì— ì‘ì„±í•´ì•¼ Layout.jsx ì˜ Outlet ì»´í¬ë„ŒíŠ¸ë¥¼ ì ìš©í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. (Routeë¡œ ê°ì‹¸ì§„ Layoutì˜ ìì‹ì´ Outletì— ë“¤ì–´ê°)

```js
// src > shared > Router.jsx
import { BrowserRouter, Route, Routes, Navigate } from "react-router-dom";
import Home from "pages/Home";
import Detail from "pages/Detail";
import Login from "pages/Login";
import Profile from "pages/Profile";
import { useSelector } from "react-redux";
import { Layout } from "components/Layout";

const Router = () => {
  const isLogin = useSelector((state) => state.auth.isLogin);
  return (
    <BrowserRouter>
      <Routes>
        {isLogin ? (
          <Route element={<Layout />}>
            {/* ë¡œê·¸ì¸ ìƒíƒœì¼ ê²½ìš° ë³´ì´ëŠ” ì»´í¬ë„ŒíŠ¸ */}
            <Route path="/" element={<Home />} />
            <Route path="/detail/:id" element={<Detail />} />
            <Route path="/profile" element={<Profile />} />
            <Route path="*" element={<Navigate replace to="/" />} />
          </Route>
        ) : (
          <>
            {/* ë¡œê·¸ì¸ ìƒíƒœê°€ ì•„ë‹ ê²½ìš° ë³´ì´ëŠ” ì»´í¬ë„ŒíŠ¸  */}
            <Route path="/login" element={<Login />} />
            <Route path="*" element={<Navigate replace to="/login" />} />
          </>
        )}
      </Routes>
    </BrowserRouter>
  );
};

export default Router;
```

![](/assets/images/2024/2024-03-03-16-11-09.png)

![](/assets/images/2024/2024-03-03-16-22-05.png)

<br>

## 5.2 ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬í•˜ê¸°

ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ë¥¼ í•´ë³´ì

Router.jsxì— ìˆëŠ” isLoginì˜ ìƒíƒœë¥¼ falseë¡œ ë°”ê¿”ì£¼ê²Œë” dispatchë¥¼ í•˜ë©´ ëœë‹¤.

```js
// Router.jsx
const isLogin = useSelector((state) => state.auth.isLogin);
```

<br>

dispatch í•˜ê¸°!

ë¡œê·¸ì•„ì›ƒì„ ëˆ„ë¥´ë©´ isLoginì´ falseë¡œ ë°”ë€Œë©´ì„œ router ì„¤ì •ì— ë”°ë¼ ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™ì´ ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

```js
// src > components > Layout.jsx
import { useDispatch } from "react-redux";
import { Link, Outlet } from "react-router-dom";
import { logout } from "store/modules/authSlice";
import styled from "styled-components";

export const Layout = () => {
  // dispatch í•¨ìˆ˜ ìƒì„±
  const dispatch = useDispatch();

  return (
    <>
      <NavbarList>
        <Link to="/">For You</Link>
        <div>
          <Link to="/profile">ë‚´ í”„ë¡œí•„</Link>
          <Link onClick={() => dispatch(logout())}>ë¡œê·¸ì•„ì›ƒ</Link>
        </div>
      </NavbarList>
      <Outlet />
    </>
  );
};
```

<br>

<br>
