---
title: "[React] 이미지 스타일링 및 프로필 변경 기능 구현하기"
categories: [React]
toc_label: Contents
toc: true
toc_sticky: true
author_profile: true
sidebar:
  nav: "counts"
---

<br>

Styled-Components를 사용하여 이미지 기본 설정과 스타일링을 구현해보자.

<br>

# 1. 기본 이미지 설정하기

> 먼저 기본 이미지를 프로젝트의 assets 폴더에 추가 후 사용하고자 하는 컴포넌트에 import 한다

이제 사용자 프로필 이미지가 없는 경우에 기본 이미지로 사용할 수 있다.

```jsx
import defaultUser from "assets/images/defaultUser.png";
```

<br>

# 2. Styled-Components로 이미지 스타일링하기

> StLetterCardAvatorFigure라는 styled-component를 정의하여 이미지 컨테이너를 스타일링한다.

```jsx
import styled from "styled-components";
import defaultUser from "assets/images/defaultUser.png";

const LetterCard = () => (
  <StLetterCardAvatorFigure>
    <img src={user.avatar || defaultUser} alt="아바타 이미지" />
  </StLetterCardAvatorFigure>
);

const StLetterCardAvatorFigure = styled.figure`
  width: 50px;
  height: 50px;
  border-radius: 50%;
  overflow: hidden;

  & img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%;
  }
`;
```

<br>

# 3. 프로필 변경 기능 구현하기

> 서버에 프로필 정보를 업데이트하기 위한 editProfile 함수를 정의한다.

이 함수는 이미지 파일과 닉네임을 FormData 객체로 서버에 전송한다.

```jsx
export const editProfile = async (data) => {
  const formData = new FormData();
  formData.append("avatar", data.avatar);
  formData.append("nickname", data.nickname);

  return await authAxios.patch("/profile", formData, {
    headers: {
      "Content-Type": "multipart/form-data",
    },
  });
};
```

<br>

> MyPage 컴포넌트에서 사용자가 프로필 이미지를 선택하고, 닉네임을 수정할 수 있는 기능을 아래와 같이 구현한다.

```jsx
import { editProfile } from "api/auth";
import { useAuth } from "context/AuthContext";
import { useState, useEffect } from "react";
import styled from "styled-components";
import defaultUser from "assets/images/defaultUser.png";

const MyPage = () => {
  const { user, setUser } = useAuth();
  const [isEditMode, setIsEditMode] = useState(false);
  const [editNickname, setEditNickname] = useState(user.nickname || ""); // 편집할 닉네임 상태
  const [imgFile, setImgFile] = useState(null); // 선택한 이미지 파일
  const [previewUrl, setPreviewUrl] = useState(""); // 이미지 미리보기 URL

  // 편집 모드가 아닐 때 원래 닉네임과 이미지를 설정
  useEffect(() => {
    setEditNickname(user.nickname || "");
    setPreviewUrl(user.avatar ? user.avatar : defaultUser);
  }, [user]);

  // 파일 선택 시 호출되는 함수
  const handleFileChange = (e) => {
    const file = e.target.files[0];
    setImgFile(file); // 선택한 파일 저장

    // 파일이 선택된 경우 미리보기 URL 생성
    if (file) {
      setPreviewUrl(URL.createObjectURL(file));
    } else {
      setPreviewUrl(user.avatar ? user.avatar : defaultUser);
    }
  };

  // 프로필 변경 처리 함수
  const handleProfileChange = async () => {
    try {
      const response = await editProfile({
        nickname: editNickname,
        avatar: imgFile,
      });
      setUser(response.data);
      alert("변경 완료!");
      setIsEditMode(false);
    } catch (error) {
      console.error("프로필 변경 중 오류 발생:", error);
    }
  };

  return (
    <div>
      <h2>프로필 관리</h2>

      {isEditMode ? (
        <>
          <StMyPageFigure>
            <img src={previewUrl} alt="아바타 이미지" />
          </StMyPageFigure>
          <input type="file" onChange={handleFileChange} />
          <input
            value={editNickname}
            onChange={(e) => setEditNickname(e.target.value)}
            placeholder="변경할 닉네임"
          />
          <button onClick={handleProfileChange}>변경완료</button>
          <button onClick={() => setIsEditMode(false)}>취소</button>
        </>
      ) : (
        <>
          <StMyPageFigure>
            <img src={user.avatar || defaultUser} alt="아바타 이미지" />
          </StMyPageFigure>
          <div>{user.nickname}</div>
          <button onClick={() => setIsEditMode(true)}>
            닉네임 및 이미지 변경
          </button>
        </>
      )}
    </div>
  );
};

export default MyPage;

const StMyPageFigure = styled.figure`
  width: 50px;
  height: 50px;
  border-radius: 50%;
  overflow: hidden;

  & img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%;
  }
`;
```
